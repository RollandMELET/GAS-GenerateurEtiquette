<!-- START OF FILE: PLAN.html -->
Generated html
<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif; line-height: 1.6; padding: 20px; color: #333; }
      h1, h2, h3 { color: #2c3e50; font-weight: 600; }
      h1 { font-size: 2em; border-bottom: 2px solid #3498db; padding-bottom: 10px; margin-top: 0; }
      h2 { font-size: 1.75em; border-bottom: 1px solid #ccc; padding-bottom: 8px; }
      h3 { font-size: 1.5em; }
      h4 { font-size: 1.25em; color: #555; }
      code { 
        background-color: #ecf0f1; 
        padding: 3px 5px; 
        border-radius: 4px; 
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        font-size: 0.9em;
        color: #e74c3c;
      }
      ul { padding-left: 20px; }
      li { margin-bottom: 10px; }
      strong { color: #2980b9; }
      em { font-style: italic; color: #7f8c8d; }
      .file-header {
        font-family: "SFMono-Regular", Consolas, "Liberation Mono", Menlo, Courier, monospace;
        font-style: italic;
        color: #7f8c8d;
        font-size: 0.9em;
        border-bottom: 1px dashed #bdc3c7;
        margin-bottom: 25px;
        padding-bottom: 10px;
      }
    </style>
  </head>
  <body>
    <div class="file-header">
      # Version: 1.0.0<br>
      # Date: 2025-06-20 11:45<br>
      # Author: AI Senior Coder<br>
      # Description: Plan d'exécution détaillé pour l'évolution du Générateur d'Étiquettes Duhalde vers la v2.0.0.
    </div>

    <h1>PLAN D'EXÉCUTION : Générateur d'Étiquettes v2.0.0</h1>

    <h2>Objectif Principal</h2>
    <p>Faire évoluer le script pour permettre la génération d'étiquettes à partir de templates Google Slides, en plus du support existant pour Google Docs. Le code sera refactorisé pour être plus modulaire et des fonctions de test internes seront ajoutées.</p>

    <hr>

    <h3>Phase 0 : Initialisation du Projet v2.0.0</h3>
    <ul>
      <li><h4>Tâche 0.1 : Versionnement de Développement</h4>
        <p><strong>Action :</strong> Avant toute modification, nous allons mentalement considérer que nous travaillons sur une version de développement. La version finale sera <code>2.0.0</code>. Le script initial est la <code>v1.0.0</code>.</p>
        <p><strong>Objectif :</strong> Poser les bases pour le suivi des modifications selon les bonnes pratiques de versionnement.</p>
      </li>
    </ul>

    <h3>Phase 1 : Refactorisation du Code Existant</h3>
    <em>L'objectif de cette phase est de rendre le code modulaire sans altérer les fonctionnalités existantes.</em>
    <ul>
      <li><h4>Tâche 1.1 : Isoler la Logique de Génération pour Google Docs</h4>
        <p><strong>Action :</strong> Créer une nouvelle fonction <code>genererEtiquettesDepuisDoc(parametres)</code>. Le contenu de cette fonction sera le cœur de la logique de l'actuelle fonction <code>genererEtiquettes</code>.</p>
        <p><strong>Objectif :</strong> Séparer la logique spécifique à <code>DocumentApp</code> dans une fonction dédiée.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
      <li><h4>Tâche 1.2 : Transformer <code>genererEtiquettes</code> en "Dispatcher"</h4>
        <p><strong>Action :</strong> Modifier la fonction <code>genererEtiquettes</code> pour qu'elle lise les paramètres, effectue les validations, puis appelle la fonction de génération appropriée.</p>
        <p><strong>Objectif :</strong> Préparer le script à gérer plusieurs types de générateurs.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
    </ul>

    <h3>Phase 2 : Implémentation du Support pour Google Slides</h3>
    <em>L'objectif est de construire la nouvelle fonctionnalité de génération via Google Slides.</em>
    <ul>
      <li><h4>Tâche 2.1 & 2.2 : Créer et Implémenter la Fonction de Génération pour Slides</h4>
        <p><strong>Action :</strong> Créer la fonction <code>genererEtiquettesDepuisSlide(parametres)</code> et y implémenter la logique avec <code>SlidesApp</code> (copie, duplication de diapositive, remplacement de texte, export PDF).</p>
        <p><strong>Objectif :</strong> Avoir une génération fonctionnelle et performante pour les templates Slides.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
    </ul>

    <h3>Phase 3 : Mise à Jour de l'Interface et de la Logique Principale</h3>
    <em>L'objectif est de permettre à l'utilisateur de choisir son type de template.</em>
    <ul>
      <li><h4>Tâche 3.1 : Guide de Mise à Jour du Google Sheet</h4>
        <p><strong>Action :</strong> Rédiger des instructions claires pour la modification du Google Sheet (ajout liste déroulante en <code>B7</code>).</p>
        <p><strong>Objectif :</strong> Préparer l'interface utilisateur.</p>
        <p><strong>Fichiers impactés :</strong> <code>README.html</code></p>
      </li>
      <li><h4>Tâche 3.2 : Adapter le "Dispatcher" <code>genererEtiquettes</code></h4>
        <p><strong>Action :</strong> Modifier <code>genererEtiquettes</code> pour lire la cellule <code>B7</code> et appeler la bonne fonction de génération en conséquence.</p>
        <p><strong>Objectif :</strong> Activer le branchement logique.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
       <li><h4>Tâche 3.3 : Mettre à Jour la Fonction <code>testerConfiguration</code></h4>
        <p><strong>Action :</strong> Modifier <code>testerConfiguration</code> pour qu'elle valide l'ID en utilisant le bon service (<code>DocumentApp</code> ou <code>SlidesApp</code>) selon la valeur en <code>B7</code>.</p>
        <p><strong>Objectif :</strong> Assurer que l'outil de diagnostic supporte les deux types de templates.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
    </ul>
    
    <h3>Phase 4 : Ajout des Fonctions de Test Internes</h3>
    <em>Objectif : Créer des fonctions pour tester la logique de base sans passer par l'interface du Google Sheet.</em>
    <ul>
      <li><h4>Tâche 4.1 : Créer la Fonction de Test pour Docs</h4>
        <p><strong>Action :</strong> Créer <code>_test_generation_doc()</code> pour appeler directement <code>genererEtiquettesDepuisDoc()</code> avec des paramètres de test.</p>
        <p><strong>Objectif :</strong> Permettre un test rapide et isolé de la génération Docs.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
      <li><h4>Tâche 4.2 : Créer la Fonction de Test pour Slides</h4>
        <p><strong>Action :</strong> Créer <code>_test_generation_slide()</code> pour appeler directement <code>genererEtiquettesDepuisSlide()</code> avec des paramètres de test.</p>
        <p><strong>Objectif :</strong> Permettre un test rapide et isolé de la génération Slides.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
    </ul>

    <h3>Phase 5 : Finalisation et Documentation</h3>
    <em>Objectif : Nettoyer, finaliser et documenter le projet.</em>
    <ul>
      <li><h4>Tâche 5.1 : Mettre à Jour <code>afficherAPropos</code></h4>
        <p><strong>Action :</strong> Mettre à jour le texte pour mentionner le support Slides et la v2.0.0.</p>
        <p><strong>Objectif :</strong> Informer l'utilisateur des nouveautés.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
      <li><h4>Tâche 5.2 : Finaliser la Version du Script</h4>
        <p><strong>Action :</strong> Mettre à jour l'en-tête de versionnement du fichier <code>script.gs</code> à <code>2.0.0</code>.</p>
        <p><strong>Objectif :</strong> Marquer officiellement la nouvelle release.</p>
        <p><strong>Fichiers impactés :</strong> <code>script.gs</code></p>
      </li>
      <li><h4>Tâche 5.3 : Finaliser le <code>README.html</code></h4>
        <p><strong>Action :</strong> Relire et compléter le <code>README.html</code> pour qu'il soit parfaitement à jour.</p>
        <p><strong>Objectif :</strong> Fournir une documentation complète.</p>
        <p><strong>Fichiers impactés :</strong> <code>README.html</code></p>
      </li>
    </ul>

  </body>
</html>
<!-- END OF FILE: PLAN.html -->